<!DOCTYPE html>
<html>
  <head>
    <base target="_top" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css"
    />
    <link
      rel="stylesheet"
      href="https://ssl.gstatic.com/docs/script/css/add-ons1.css"
    />
    <script>
      function saveSetting() {
        const button = document.getElementById("save-button");
        button.innerText = "Saving...";
        button.disabled = true;
        button.className = "gray";

        const citationStyleSelect = document.getElementById("citation-style");
        const citationStyle =
          citationStyleSelect.options[citationStyleSelect.selectedIndex].value;
        google.script.run
          .withSuccessHandler(function () {
            button.innerText = "Save";
            button.disabled = false;
            button.className = "blue";
          })
          .saveSetting(citationStyle);
      }
    </script>
  </head>
  <body>
    <style>
      .branding-below {
        bottom: 56px;
        top: 0;
      }
    </style>

    <div class="sidebar branding-below">
      <div class="block form-group">
        <label for="translated-text">Citation style:</label>
        <select id="citation-style">
          <?!= stylesHTML ?>
        </select>
      </div>

      <div class="block form-group">
        <button
          class="blue"
          id="save-button"
          style="width: 100%"
          onclick="saveSetting()"
        >
          Save
        </button>
      </div>
    </div>

    <div class="sidebar bottom">
      <span class="gray"> This add-ons is not created by Mendeley.</span>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
    <script>
      const element = document.getElementById("citation-style");
      document.addEventListener("DOMContentLoaded", (event) => {
        const choices = new Choices(element, {
          searchEnabled: true,
          itemSelectText: "",
          searchResultLimit: 20,
        });
      });
    </script>
  </body>
</html>
